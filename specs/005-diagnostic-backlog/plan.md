# Implementation Plan: Consolidated Diagnostic Backlog

**Branch**: `005-diagnostic-backlog` | **Date**: 2026-02-22 | **Spec**: [spec.md](./spec.md)
**Input**: Feature specification from `/specs/005-diagnostic-backlog/spec.md`

## Summary

Generate a consolidated backlog report (`diagnostics/reports/02-backlog.md`) by analyzing the existing diagnostic reports (00-project-mapping.md and 01-link-crawler.md). The report categorizes all identified issues into 5 sections (Críticos, Isolamento de Dados, Páginas Placeholder, Links Quebrados, Melhorias de UX) with per-item descriptions, affected roles, effort estimates, and solution suggestions. This is a documentation-only task — no application code is modified.

## Technical Context

**Language/Version**: Markdown (report generation only)
**Primary Dependencies**: None (reads existing Markdown reports, writes Markdown output)
**Storage**: Filesystem only — `diagnostics/reports/02-backlog.md`
**Testing**: Manual validation against checklist (no automated tests for report content)
**Target Platform**: N/A (Markdown document)
**Project Type**: Documentation
**Performance Goals**: N/A
**Constraints**: Report must be generated from existing diagnostic data only; no new crawls or code analysis
**Scale/Scope**: ~20-30 backlog items consolidated from 2 source reports

## Constitution Check

_GATE: Must pass before Phase 0 research. Re-check after Phase 1 design._

| Principle                              | Status | Notes                                                                |
| -------------------------------------- | ------ | -------------------------------------------------------------------- |
| I. Code Quality First                  | N/A    | No code written — Markdown report only                               |
| II. Test-Driven Development            | N/A    | No testable code — manual validation via checklist                   |
| III. User Experience Consistency       | PASS   | Report written in Portuguese for stakeholders                        |
| IV. Performance and Scalability        | N/A    | No runtime component                                                 |
| V. Security and Compliance             | PASS   | Report documents LGPD-relevant items (missing /termos, /privacidade) |
| VI. Architecture and Modularity        | N/A    | No code changes                                                      |
| VII. Documentation and Maintainability | PASS   | Report follows structured format with clear categories               |
| VIII. Development Workflow             | PASS   | Feature branch workflow, commit conventions followed                 |

**Gate Result**: PASS — No violations. Documentation-only feature.

## Project Structure

### Documentation (this feature)

```text
specs/005-diagnostic-backlog/
├── plan.md              # This file
├── research.md          # Analysis methodology and decisions
├── data-model.md        # Backlog item structure
├── quickstart.md        # How to generate/update the backlog
├── checklists/
│   └── requirements.md  # Spec quality checklist (16/16 PASS)
└── tasks.md             # Task breakdown (generated by /speckit.tasks)
```

### Output (repository root)

```text
diagnostics/reports/
├── 00-project-mapping.md   # SOURCE: Project structure & route mapping
├── 01-link-crawler.md      # SOURCE: Navigation diagnostic crawl results
└── 02-backlog.md           # OUTPUT: Consolidated backlog (this feature)
```

**Structure Decision**: No source code directories involved. This feature reads from and writes to the `diagnostics/reports/` directory only.

## Report Structure

The output `02-backlog.md` follows this structure:

```markdown
# Backlog Consolidado - Consultor.AI

## Dados de Origem (source reports + dates)

## Resumo Executivo (totals by category and effort)

## 1. Críticos (blocks main user flow)

## 2. Isolamento de Dados entre Tenants (RLS/security)

## 3. Páginas Placeholder (empty/TODO content)

## 4. Links Quebrados (404s, bad redirects)

## 5. Melhorias de UX (duplicates, naming, polish)

## 6. Roadmap Futuro (Phase 5 items, no effort estimate)
```

Each backlog item uses this format:

```markdown
### BL-XXX: [Title]

- **Descrição**: What the problem is
- **Papel afetado**: admin / consultant / público
- **Esforço**: P (≤2h) / M (½-1 dia) / G (>1 dia)
- **Sugestão de solução**: High-level fix approach
- **Rotas relacionadas**: Affected routes
```

## Data Extraction Plan

### From 01-link-crawler.md (Navigation Diagnostic)

| Source Section                                 | Target Category    | Items                                                              |
| ---------------------------------------------- | ------------------ | ------------------------------------------------------------------ |
| Acesso Negado Inesperado (72 routes)           | 1. Críticos        | 1 root cause item (SSR cookie auth) with sub-items                 |
| Quebrado (4 routes)                            | 1. Críticos        | 2 items (missing seed data for fileId, crmIntegrationId)           |
| Links Internos Quebrados (8 entries, 4 unique) | 4. Links Quebrados | 4 items (/auth/signup, /termos, /privacidade, /dashboard redirect) |
| Placeholder (0 routes)                         | 3. Placeholder     | 0 items (documented as clean)                                      |

### From 00-project-mapping.md (Project Mapping)

| Source Section                         | Target Category   | Items                                              |
| -------------------------------------- | ----------------- | -------------------------------------------------- |
| Observação: duplicidade flows/fluxos   | 5. Melhorias UX   | 1 item (route consolidation)                       |
| Rotas Previstas mas Ausentes (5 items) | 6. Roadmap Futuro | 5 items (HubSpot, Agendor, Imóveis, Voice, Images) |
| RLS policies ativas (Section 6.1)      | 2. Isolamento     | Assessment of current RLS coverage                 |
| Camadas de Defesa (6 níveis)           | 2. Isolamento     | Assessment of auth layer completeness              |

### Cross-Report Analysis

| Analysis                                     | Target Category            | Items                                  |
| -------------------------------------------- | -------------------------- | -------------------------------------- |
| Auth cookie not recognized by middleware     | 1. Críticos                | Root cause for 72 access denied routes |
| Missing /termos and /privacidade pages       | 4. Links Quebrados + 5. UX | LGPD compliance gap                    |
| Naming inconsistency (EN vs PT-BR in routes) | 5. Melhorias UX            | Pattern identified across routes       |

## Effort Estimation Criteria

| Effort | Label   | Time          | Examples                                                                |
| ------ | ------- | ------------- | ----------------------------------------------------------------------- |
| P      | Pequeno | ≤ 2 horas     | Fix a broken link, create a redirect, add a static page                 |
| M      | Médio   | ½ dia a 1 dia | Fix auth cookie format, add seed data for missing entities              |
| G      | Grande  | > 1 dia       | Implement RLS audit, consolidate duplicate routes, add new CRM provider |

## Complexity Tracking

No complexity violations — this is a documentation-only feature with no code changes.
